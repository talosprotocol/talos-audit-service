#!/usr/bin/env bash
# Pre-push hook for talos-audit-service
# Final validation before pushing to remote
set -euo pipefail

echo "ğŸš€ Running pre-push validations..."

# 1. Full lint check (no auto-fix, must be clean)
echo "ğŸ” Lint check..."
ruff check .
ruff format --check .

# 2. Run full test suite with coverage
echo "ğŸ§ª Running tests with coverage..."
PYTHONPATH=. pytest --cov=src --cov-report=term-missing

# 3. Docker build validation
echo "ğŸ³ Validating Docker build..."
docker build -t talos-audit-service:pre-push-check . --quiet

echo "âœ… All pre-push checks passed! Ready to push."
